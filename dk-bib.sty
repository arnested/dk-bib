% Copyright 2004 by Arne Jorgensen

% This file is free software; you can redistribute it and/or modify
% it under the terms of the GNU General Public License as published by
% the Free Software Foundation; either version 2 of the License, or
% (at your option) any later version.

% This program is distributed in the hope that it will be useful, but
% WITHOUT ANY WARRANTY; without even the implied warranty of
% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
% General Public License for more details.

% You should have received a copy of the GNU General Public License
% along with this program; if not, write to the Free Software
% Foundation, Inc., 59 Temple Place - Suite 330, Boston,
% MA 02111-1307, USA.

\NeedsTeXFormat{LaTeX2e}[1995/12/01]

% subversion date and revision
\def\dkbib@svn $#1 #2 #3 #4-#5-#6 #7 #8 ${%
  \def\dkbib@sty@revision{#3}
  \def\dkbib@sty@date{#4/#5/#6}
}
\dkbib@svn $Id$
\def\dkbib@version{0.2}

\ProvidesPackage{dk-bib}[\dkbib@sty@date\space v\dkbib@version\space(r\dkbib@sty@revision) Danish variants of the standard BibTeX styles]

\RequirePackage{xkeyval}

\newif\ifdkbib@url
\dkbib@urlfalse
\DeclareOptionX{url}[true]{%
  \csname dkbib@url#1\endcsname}

\newif\ifdkbib@isbn
\dkbib@isbnfalse
\DeclareOptionX{isbn}[true]{%
  \csname dkbib@isbn#1\endcsname}

\newif\ifdkbib@issn
\dkbib@issnfalse
\DeclareOptionX{issn}[true]{%
  \csname dkbib@issn#1\endcsname}

\newif\ifdkbib@printing
\dkbib@printingfalse
\DeclareOptionX{printing}[true]{%
  \csname dkbib@printing#1\endcsname}

\newif\ifdkbib@ordinalstoword
\dkbib@ordinalstowordfalse
\DeclareOptionX{ordinals2word}[true]{%
  \csname dkbib@ordinalstoword#1\endcsname}

\newcount\dkbib@ordinaldepth
\dkbib@ordinaldepth20
\DeclareOptionX{ordinaldepth}{%
  \dkbib@ordinaldepth#1}

\ProcessOptionsX

\RequirePackage{ifthen}
\def\@dkbibordinalstoword#1{%
  \ifthenelse{\equal{#1}{1.}\and\dkbib@ordinaldepth>\z@}{\def\dkbib@this{f\o rste}}{%
    \ifthenelse{\equal{#1}{2.}\and\dkbib@ordinaldepth>\@ne}{\def\dkbib@this{anden}}{%
      \ifthenelse{\equal{#1}{3.}\and\dkbib@ordinaldepth>\tw@}{\def\dkbib@this{tredje}}{%
        \ifthenelse{\equal{#1}{4.}\and\dkbib@ordinaldepth>\thr@@}{\def\dkbib@this{fjerde}}{%
          \ifthenelse{\equal{#1}{5.}\and\dkbib@ordinaldepth>4}{\def\dkbib@this{femte}}{%
            \ifthenelse{\equal{#1}{6.}\and\dkbib@ordinaldepth>5}{\def\dkbib@this{sjette}}{%
              \ifthenelse{\equal{#1}{7.}\and\dkbib@ordinaldepth>6}{\def\dkbib@this{syvende}}{%
                \ifthenelse{\equal{#1}{8.}\and\dkbib@ordinaldepth>7}{\def\dkbib@this{ottende}}{%
                  \ifthenelse{\equal{#1}{9.}\and\dkbib@ordinaldepth>8}{\def\dkbib@this{niende}}{%
                    \ifthenelse{\equal{#1}{10.}\and\dkbib@ordinaldepth>9}{\def\dkbib@this{tiende}}{%
                      \ifthenelse{\equal{#1}{11.}\and\dkbib@ordinaldepth>10}{\def\dkbib@this{elvte}}{%
                        \ifthenelse{\equal{#1}{12.}\and\dkbib@ordinaldepth>11}{\def\dkbib@this{tolvte}}{%
                          \ifthenelse{\equal{#1}{13.}\and\dkbib@ordinaldepth>12}{\def\dkbib@this{trettende}}{%
                            \ifthenelse{\equal{#1}{14.}\and\dkbib@ordinaldepth>13}{\def\dkbib@this{fjortende}}{%
                              \ifthenelse{\equal{#1}{15.}\and\dkbib@ordinaldepth>14}{\def\dkbib@this{femtende}}{%
                                \ifthenelse{\equal{#1}{16.}\and\dkbib@ordinaldepth>15}{\def\dkbib@this{sekstende}}{%
                                  \ifthenelse{\equal{#1}{17.}\and\dkbib@ordinaldepth>\sixt@@n}{\def\dkbib@this{syttende}}{%
                                    \ifthenelse{\equal{#1}{18.}\and\dkbib@ordinaldepth>17}{\def\dkbib@this{attende}}{%
                                      \ifthenelse{\equal{#1}{19.}\and\dkbib@ordinaldepth>18}{\def\dkbib@this{nittende}}{%
                                        \ifthenelse{\equal{#1}{20.}\and\dkbib@ordinaldepth>19}{\def\dkbib@this{tyvende}}{%
                                          \def\dkbib@this{#1}}}}}}}}}}}}}}}}}}}}}%
}

\AtBeginDocument{%
  %%% url
  \ifdkbib@url%
    \RequirePackage{url}%
    \expandafter\ifx\csname dkbiburl\endcsname\relax\def\dkbiburl#1{URL \url{#1}}\fi%
  \else%
    \def\dkbiburl#1.{\relax}%
  \fi%
  %%% isbn
  \ifdkbib@isbn%
    \expandafter\ifx\csname dkbibisbn\endcsname\relax\def\dkbibisbn#1{ISBN #1}\fi%
  \else%
    \def\dkbibisbn#1.{\relax}%
  \fi%
  %%% issn
  \ifdkbib@issn%
    \expandafter\ifx\csname dkbibissn\endcsname\relax\def\dkbibissn#1{ISSN #1}\fi%
  \else%
    \def\dkbibissn#1.{\relax}%
  \fi%
  %%% printing
  \ifdkbib@printing%
    \ifdkbib@ordinalstoword%
      \def\dkbibPrinting#1{%
        \@dkbibordinalstoword{#1}%
        \expandafter\MakeUppercase\dkbib@this~oplag}
      \def\dkbibprinting#1{%
        \@dkbibordinalstoword{#1}%
        \dkbib@this~oplag}
    \else
      \expandafter\ifx\csname dkbibprinting\endcsname\relax\def\dkbibprinting#1{#1~oplag}\fi%
      \expandafter\ifx\csname dkbibPrinting\endcsname\relax\def\dkbibPrinting#1{#1~oplag}\fi%
    \fi
  \else%
    \def\dkbibprinting#1,{\relax}%
    \def\dkbibPrinting#1,{\relax}%
  \fi%
  %%% edition
  \ifdkbib@ordinalstoword%
    \def\dkbibEdition#1{%
      \@dkbibordinalstoword{#1}%
      \expandafter\MakeUppercase\dkbib@this}
    \def\dkbibedition#1{%
      \@dkbibordinalstoword{#1}%
      \dkbib@this}
  \else
    \def\dkbibEdition#1{#1}%
    \def\dkbibedition#1{#1}%
  \fi%
}
